/**
  * Post Controller includes all of the endpoints relating to post management in our app
  */
 
  const { User } = require("../models/userModel");
  const { RequestPostTags } = require("../models/requestPostTagsModel");
  const { RequestPost } = require("../models/requestPostModel");
  const getRequest = async (req, res) => {
   try {
     const offerId = req.postId;
     const response = await RequestPost.findByPk(offerId, {include: ["offerTags"]});
     res.json(response);
     res.sendStatus(200);
    } catch (error) {
      console.log("Error finding an offer post: " + e);
      res.sendStatus(500);
    }
  };

  const searchRequests = async (req, res) => {
    try {
      const title = req.title;
      const query = "%" + title + "%";

      //find all posts which have a title containing the query
      const response = await OfferPost.findAll({
          where: {
              title: {[Op.like]: query}, 
            }
      });
      if (response = null) {
          const message = "Sorry, there are no offer posts for " + title + "."
          res.json({
              message: message
          });
          res.sendStatus(200);
      } else {
          res.json(response);
          res.sendStatus(200);
      }
  } catch (error) {
    console.log("Error with searching for offer posts: " + e);
    res.sendStatus(500);
  }
}

  //Create a new post
  const createRequest = async (req, res) => {
      const { id } = req.body;
      const response = null;
      res.json(response);
  }

  //Update post
  const updateRequest = async (req, res) => {
      const { id } = req.body;
      const response = null;
      res.json(response);
  }

  //Delete post
  const deleteRequest = async (req, res) => {
      const { id } = req.body;
      const response = null;
      res.json(response);
  }

  module.exports = {
    getRequest,
    searchRequests,
    createRequest,
    updateRequest,
    deleteRequest
  };
  